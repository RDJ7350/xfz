function Banners(){}Banners.prototype.listenImageSelectEvent=function(n){var t=n.find(".thumbnail"),e=n.find(".image-input");t.click(function(){e.click()}),e.change(function(){var n=this.files[0],e=new FormData;e.append("file",n),xfzajax.post({url:"/cms/upload_file/",data:e,processData:!1,contentType:!1,success:function(n){if(200===n.code){var e=n.data.url;t.attr("src",e)}}})})},Banners.prototype.listenCloseBtnEvent=function(e){var n=e.find(".close-btn"),t=e.attr("banner-id");n.click(function(){t?xfzalert.alertConfirm({text:"确定要删除该轮播图吗？",confirmCallback:function(){console.log("删除成功"),xfzajax.post({url:"/cms/delete_banner/",data:{banner_id:t},success:function(n){200===n.code&&xfzalert.alertSuccess("轮播图删除成功！",function(){e.remove()})}})}}):e.remove()})},Banners.prototype.listenAddBannerSaveEvent=function(a){var n=a.find(".save-btn"),r=a.find("input[name='priority']"),i=a.find("input[name='link_to']"),s=a.find(".thumbnail"),o=a.find(".priority"),c=a.attr("banner-id"),l="";l=c?"/cms/edit_banner/":"/cms/add_banners/",n.click(function(){var e=r.val(),n=i.val(),t=s.attr("src");xfzajax.post({url:l,data:{priority:e,link_to:n,image_url:t,pk:c},success:function(n){200===n.code&&(c?xfzalert.alertSuccess("轮播图修改成功！",function(){}):(c=n.data.banner_id,xfzalert.alertSuccess("轮播图添加成功！",function(){a.attr("banner-id",c)})),o.text("优先级："+e))}})})},Banners.prototype.listenAddBtnEvent=function(){var n=this,e=$("#add-banners-btn"),t=$(".banners-list-group");e.click(function(){6<=t.children().length?window.messageBox.showInfo("最多只能添加6张轮播图！"):n.createBannerItem()})},Banners.prototype.loadBannerEvent=function(){var r=this;xfzajax.get({url:"/cms/banner_list/",success:function(n){if(200===n.code)for(var e=n.data,t=0;t<e.length;t++){var a=e[t];r.createBannerItem(a)}}})},Banners.prototype.createBannerItem=function(n){var e=this,t=$(".banners-list-group"),a=template("banners-group",{banners:n}),r=null;r=n?(t.append(a),t.find(".banner-item:last")):(t.prepend(a),t.find(".banner-item:first")),e.listenImageSelectEvent(r),e.listenCloseBtnEvent(r),e.listenAddBannerSaveEvent(r)},Banners.prototype.run=function(){this.listenAddBtnEvent(),this.loadBannerEvent()},$(function(){(new Banners).run()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJhbm5lcnMuanMiXSwibmFtZXMiOlsiQmFubmVycyIsInByb3RvdHlwZSIsImxpc3RlbkltYWdlU2VsZWN0RXZlbnQiLCJiYW5uZXJJdGVtIiwiaW1hZ2UiLCJmaW5kIiwiaW1hZ2VJbnB1dCIsImNsaWNrIiwiY2hhbmdlIiwiZmlsZSIsInRoaXMiLCJmaWxlcyIsImZvcm1EYXRhIiwiRm9ybURhdGEiLCJhcHBlbmQiLCJ4ZnphamF4IiwicG9zdCIsInVybCIsImRhdGEiLCJwcm9jZXNzRGF0YSIsImNvbnRlbnRUeXBlIiwic3VjY2VzcyIsInJlc3VsdCIsImF0dHIiLCJsaXN0ZW5DbG9zZUJ0bkV2ZW50IiwiY2xvc2VCdG4iLCJiYW5uZXJJZCIsInhmemFsZXJ0IiwiYWxlcnRDb25maXJtIiwidGV4dCIsImNvbmZpcm1DYWxsYmFjayIsImNvbnNvbGUiLCJsb2ciLCJiYW5uZXJfaWQiLCJhbGVydFN1Y2Nlc3MiLCJyZW1vdmUiLCJsaXN0ZW5BZGRCYW5uZXJTYXZlRXZlbnQiLCJzYXZlQnRuIiwicHJpb3JpdHlUYWciLCJsaW5rVG9UYWciLCJpbWFnZWxUYWciLCJwcmlvcml0eVNwYW4iLCJwcmlvcml0eSIsInZhbCIsImxpbmtUbyIsImltYWdlVXJsIiwibGlua190byIsImltYWdlX3VybCIsInBrIiwibGlzdGVuQWRkQnRuRXZlbnQiLCJzZWxmIiwiYWRkQnRuIiwiJCIsImJhbm5lckdyb3VwIiwiY2hpbGRyZW4iLCJsZW5ndGgiLCJ3aW5kb3ciLCJtZXNzYWdlQm94Iiwic2hvd0luZm8iLCJjcmVhdGVCYW5uZXJJdGVtIiwibG9hZEJhbm5lckV2ZW50IiwiZ2V0IiwiYmFubmVycyIsImkiLCJiYW5uZXIiLCJiYW5uZXJzTGlzdEdyb3VwIiwidHBsIiwidGVtcGxhdGUiLCJwcmVwZW5kIiwicnVuIl0sIm1hcHBpbmdzIjoiQUFBQSxTQUFTQSxXQUlUQSxRQUFRQyxVQUFVQyx1QkFBeUIsU0FBU0MsR0FDaEQsSUFBSUMsRUFBUUQsRUFBV0UsS0FBSyxj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QWlCNUQsS0FBSyx1QkFFdkM2QyxFQUFLaEQsdUJBQXVCQyxHQUM1QitDLEVBQUsxQixvQkFBb0JyQixHQUN6QitDLEVBQUtkLHlCQUF5QmpDLElBaUNsQ0gsUUFBUUMsVUFBVW9FLElBQU0sV0FDVDNELEtBQ051QyxvQkFETXZDLEtBRU5rRCxtQkFHVFIsRUFBRSxZQUNnQixJQUFJcEQsU0FDVnFFIiwiZmlsZSI6ImJhbm5lcnMubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gQmFubmVycygpIHtcclxuXHJcbn1cclxuXHJcbkJhbm5lcnMucHJvdG90eXBlLmxpc3RlbkltYWdlU2VsZWN0RXZlbnQgPSBmdW5jdGlvbihiYW5uZXJJdGVtKXtcclxuICAgIHZhciBpbWFnZSA9IGJhbm5lckl0ZW0uZmluZChcIi50aHVtYm5haWxcIik7XHJcbiAgICB2YXIgaW1hZ2VJbnB1dCA9IGJhbm5lckl0ZW0uZmluZChcIi5pbWFnZS1pbnB1dFwiKTtcclxuICAgIGltYWdlLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpbWFnZUlucHV0LmNsaWNrKCk7XHJcbiAgICB9KTtcclxuICAgIGltYWdlSW5wdXQuY2hhbmdlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgZmlsZSA9IHRoaXMuZmlsZXNbMF07XHJcbiAgICAgICAgdmFyIGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7XHJcbiAgICAgICAgZm9ybURhdGEuYXBwZW5kKFwiZmlsZVwiLCBmaWxlKTtcclxuICAgICAgICB4ZnphamF4LnBvc3QoIHtcclxuICAgICAgICAgICAgJ3VybCc6ICcvY21zL3VwbG9hZF9maWxlLycsXHJcbiAgICAgICAgICAgICdkYXRhJzogZm9ybURhdGEsXHJcbiAgICAgICAgICAgICdwcm9jZXNzRGF0YSc6IGZhbHNlLFxyXG4gICAgICAgICAgICAnY29udGVudFR5cGUnOiBmYWxzZSxcclxuICAgICAgICAgICAgJ3N1Y2Nlc3MnOiBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0Wydjb2RlJ10gPT09IDIwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB1cmwgPSByZXN1bHRbJ2RhdGEnXVsndXJsJ107XHJcbiAgICAgICAgICAgICAgICAgICAgaW1hZ2UuYXR0cihcInNyY1wiLCB1cmwpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgIH0pXHJcbn07XHJcblxyXG5CYW5uZXJzLnByb3RvdHlwZS5saXN0ZW5DbG9zZUJ0bkV2ZW50ID0gZnVuY3Rpb24oYmFubmVySXRlbSl7XHJcbiAgICB2YXIgY2xvc2VCdG4gPSBiYW5uZXJJdGVtLmZpbmQoXCIuY2xvc2UtYnRuXCIpO1xyXG4gICAgdmFyIGJhbm5lcklkID0gYmFubmVySXRlbS5hdHRyKFwiYmFubmVyLWlkXCIpO1xyXG4gICAgY2xvc2VCdG4uY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmIChiYW5uZXJJZCl7XHJcbiAgICAgICAgICAgIHhmemFsZXJ0LmFsZXJ0Q29uZmlybSgge1xyXG4gICAgICAgICAgICAgICAgJ3RleHQnOiBcIuehruWumuimgeWIoOmZpOivpei9ruaSreWbvuWQl++8n1wiLFxyXG4gICAgICAgICAgICAgICAgJ2NvbmZpcm1DYWxsYmFjayc6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIuWIoOmZpOaIkOWKn1wiKTtcclxuICAgICAgICAgICAgICAgICAgICB4ZnphamF4LnBvc3Qoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAndXJsJzogJy9jbXMvZGVsZXRlX2Jhbm5lci8nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAnZGF0YSc6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdiYW5uZXJfaWQnOmJhbm5lcklkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICdzdWNjZXNzJzogZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdFsnY29kZSddID09PSAyMDApe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhmemFsZXJ0LmFsZXJ0U3VjY2VzcyhcIui9ruaSreWbvuWIoOmZpOaIkOWKn++8gVwiLGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFubmVySXRlbS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgYmFubmVySXRlbS5yZW1vdmUoKTtcclxuICAgICAgICB9XHJcbiAgICB9KVxyXG59O1xyXG5cclxuQmFubmVycy5wcm90b3R5cGUubGlzdGVuQWRkQmFubmVyU2F2ZUV2ZW50ID0gZnVuY3Rpb24oYmFubmVySXRlbSl7XHJcbiAgICB2YXIgc2F2ZUJ0biA9IGJhbm5lckl0ZW0uZmluZChcIi5zYXZlLWJ0blwiKTtcclxuICAgIHZhciBwcmlvcml0eVRhZyA9IGJhbm5lckl0ZW0uZmluZChcImlucHV0W25hbWU9J3ByaW9yaXR5J11cIik7XHJcbiAgICB2YXIgbGlua1RvVGFnID0gYmFubmVySXRlbS5maW5kKFwiaW5wdXRbbmFtZT0nbGlua190byddXCIpO1xyXG4gICAgdmFyIGltYWdlbFRhZyA9IGJhbm5lckl0ZW0uZmluZChcIi50aHVtYm5haWxcIik7XHJcbiAgICB2YXIgcHJpb3JpdHlTcGFuID0gYmFubmVySXRlbS5maW5kKFwiLnByaW9yaXR5XCIpO1xyXG4gICAgdmFyIGJhbm5lcl9pZCA9IGJhbm5lckl0ZW0uYXR0cihcImJhbm5lci1pZFwiKTtcclxuICAgIHZhciB1cmwgPSAnJztcclxuICAgIGlmIChiYW5uZXJfaWQpe1xyXG4gICAgICAgIHVybCA9ICcvY21zL2VkaXRfYmFubmVyLyc7XHJcbiAgICB9ZWxzZSB7XHJcbiAgICAgICAgdXJsID0gJy9jbXMvYWRkX2Jhbm5lcnMvJ1xyXG4gICAgfVxyXG4gICAgc2F2ZUJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHByaW9yaXR5ID0gcHJpb3JpdHlUYWcudmFsKCk7XHJcbiAgICAgICAgdmFyIGxpbmtUbyA9IGxpbmtUb1RhZy52YWwoKTtcclxuICAgICAgICB2YXIgaW1hZ2VVcmwgPSBpbWFnZWxUYWcuYXR0cihcInNyY1wiKTtcclxuICAgICAgICB4ZnphamF4LnBvc3Qoe1xyXG4gICAgICAgICAgICAndXJsJzogdXJsLFxyXG4gICAgICAgICAgICAnZGF0YSc6IHtcclxuICAgICAgICAgICAgICAgICdwcmlvcml0eSc6IHByaW9yaXR5LFxyXG4gICAgICAgICAgICAgICAgJ2xpbmtfdG8nOiBsaW5rVG8sXHJcbiAgICAgICAgICAgICAgICAnaW1hZ2VfdXJsJzogaW1hZ2VVcmwsXHJcbiAgICAgICAgICAgICAgICAncGsnOiBiYW5uZXJfaWQsXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICdzdWNjZXNzJzogZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdFsnY29kZSddID09PSAyMDApe1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChiYW5uZXJfaWQpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB4ZnphbGVydC5hbGVydFN1Y2Nlc3MoXCLova7mkq3lm77kv67mlLnmiJDlip/vvIFcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhbm5lcl9pZCA9IHJlc3VsdFsnZGF0YSddWydiYW5uZXJfaWQnXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgeGZ6YWxlcnQuYWxlcnRTdWNjZXNzKFwi6L2u5pKt5Zu+5re75Yqg5oiQ5Yqf77yBXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhbm5lckl0ZW0uYXR0cihcImJhbm5lci1pZFwiLCBiYW5uZXJfaWQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICBwcmlvcml0eVNwYW4udGV4dChcIuS8mOWFiOe6p++8mlwiK3ByaW9yaXR5KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICB9KVxyXG59O1xyXG5cclxuQmFubmVycy5wcm90b3R5cGUubGlzdGVuQWRkQnRuRXZlbnQgPSBmdW5jdGlvbigpe1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdmFyIGFkZEJ0biA9ICQoXCIjYWRkLWJhbm5lcnMtYnRuXCIpO1xyXG4gICAgdmFyIGJhbm5lckdyb3VwID0gJChcIi5iYW5uZXJzLWxpc3QtZ3JvdXBcIik7XHJcbiAgICBhZGRCdG4uY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBsZW5ndGggPSBiYW5uZXJHcm91cC5jaGlsZHJlbigpLmxlbmd0aDtcclxuICAgICAgICBpZihsZW5ndGg+PTYpIHtcclxuICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvd0luZm8oXCLmnIDlpJrlj6rog73mt7vliqA25byg6L2u5pKt5Zu+77yBXCIpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHNlbGYuY3JlYXRlQmFubmVySXRlbSgpO1xyXG4gICAgfSlcclxufTtcclxuXHJcbkJhbm5lcnMucHJvdG90eXBlLmxvYWRCYW5uZXJFdmVudCA9IGZ1bmN0aW9uKCl7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB4ZnphamF4LmdldCh7XHJcbiAgICAgICAgJ3VybCc6ICcvY21zL2Jhbm5lcl9saXN0LycsXHJcbiAgICAgICAgJ3N1Y2Nlc3MnOiBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgaWYgKHJlc3VsdFsnY29kZSddID09PSAyMDApe1xyXG4gICAgICAgICAgICAgICB2YXIgYmFubmVycyA9IHJlc3VsdFsnZGF0YSddO1xyXG4gICAgICAgICAgICAgICBmb3IgKHZhciBpPTA7aTxiYW5uZXJzLmxlbmd0aDsgaSsrKXtcclxuICAgICAgICAgICAgICAgICAgIHZhciBiYW5uZXIgPSBiYW5uZXJzW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgc2VsZi5jcmVhdGVCYW5uZXJJdGVtKGJhbm5lcik7XHJcbiAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn07XHJcblxyXG5CYW5uZXJzLnByb3RvdHlwZS5jcmVhdGVCYW5uZXJJdGVtID0gZnVuY3Rpb24oYmFubmVyKXtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHZhciBiYW5uZXJzTGlzdEdyb3VwID0gJChcIi5iYW5uZXJzLWxpc3QtZ3JvdXBcIik7XHJcbiAgICB2YXIgdHBsID0gdGVtcGxhdGUoXCJiYW5uZXJzLWdyb3VwXCIgLHtcImJhbm5lcnNcIjogYmFubmVyfSk7XHJcbiAgICB2YXIgYmFubmVySXRlbSA9IG51bGw7XHJcbiAgICBpZiAoYmFubmVyKXtcclxuICAgICAgICBiYW5uZXJzTGlzdEdyb3VwLmFwcGVuZCh0cGwpO1xyXG4gICAgICAgIGJhbm5lckl0ZW0gPSBiYW5uZXJzTGlzdEdyb3VwLmZpbmQoXCIuYmFubmVyLWl0ZW06bGFzdFwiKTtcclxuICAgIH1lbHNlIHtcclxuICAgICAgICBiYW5uZXJzTGlzdEdyb3VwLnByZXBlbmQodHBsKTtcclxuICAgICAgICBiYW5uZXJJdGVtID0gYmFubmVyc0xpc3RHcm91cC5maW5kKFwiLmJhbm5lci1pdGVtOmZpcnN0XCIpO1xyXG4gICAgfVxyXG4gICAgc2VsZi5saXN0ZW5JbWFnZVNlbGVjdEV2ZW50KGJhbm5lckl0ZW0pO1xyXG4gICAgc2VsZi5saXN0ZW5DbG9zZUJ0bkV2ZW50KGJhbm5lckl0ZW0pO1xyXG4gICAgc2VsZi5saXN0ZW5BZGRCYW5uZXJTYXZlRXZlbnQoYmFubmVySXRlbSk7XHJcbiAgICAvLyBzZWxmLmxpc3RlbkVkaXRCYW5uZXJFdmVudChiYW5uZXJJdGVtKTtcclxufTtcclxuXHJcbi8vIEJhbm5lcnMucHJvdG90eXBlLmxpc3RlbkVkaXRCYW5uZXJFdmVudCA9IGZ1bmN0aW9uKGJhbm5lckl0ZW0pe1xyXG4vLyAgICAgdmFyIGVkaXRCdG4gPSBiYW5uZXJJdGVtLmZpbmQoXCIuZWRpdC1idG5cIik7XHJcbi8vICAgICB2YXIgcHJpb3JpdHlUYWcgPSBiYW5uZXJJdGVtLmZpbmQoXCJpbnB1dFtuYW1lPSdwcmlvcml0eSddXCIpO1xyXG4vLyAgICAgdmFyIGxpbmtUb1RhZyA9IGJhbm5lckl0ZW0uZmluZChcImlucHV0W25hbWU9J2xpbmtfdG8nXVwiKTtcclxuLy8gICAgIHZhciBpbWFnZWxUYWcgPSBiYW5uZXJJdGVtLmZpbmQoXCIudGh1bWJuYWlsXCIpO1xyXG4vLyAgICAgdmFyIGJhbm5lcl9pZCA9IGJhbm5lckl0ZW0uYXR0cihcImJhbm5lci1pZFwiKTtcclxuLy8gICAgIGVkaXRCdG4uY2xpY2soZnVuY3Rpb24gKCkge1xyXG4vLyAgICAgICAgIHZhciBwcmlvcml0eSA9IHByaW9yaXR5VGFnLnZhbCgpO1xyXG4vLyAgICAgICAgIHZhciBsaW5rVG8gPSBsaW5rVG9UYWcudmFsKCk7XHJcbi8vICAgICAgICAgdmFyIGltYWdlVXJsID0gaW1hZ2VsVGFnLmF0dHIoXCJzcmNcIik7XHJcbi8vICAgICAgICAgeGZ6YWpheC5wb3N0KHtcclxuLy8gICAgICAgICAgICAgJ3VybCc6ICcvY21zL2VkaXRfYmFubmVyLycsXHJcbi8vICAgICAgICAgICAgICdkYXRhJzoge1xyXG4vLyAgICAgICAgICAgICAgICAgJ3ByaW9yaXR5JzogcHJpb3JpdHksXHJcbi8vICAgICAgICAgICAgICAgICAnbGlua190byc6IGxpbmtUbyxcclxuLy8gICAgICAgICAgICAgICAgICdpbWFnZV91cmwnOiBpbWFnZVVybCxcclxuLy8gICAgICAgICAgICAgICAgICdwayc6IGJhbm5lcl9pZCxcclxuLy8gICAgICAgICAgICAgfSxcclxuLy8gICAgICAgICAgICAgJ3N1Y2Nlc3MnOiBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbi8vICAgICAgICAgICAgICAgICBpZiAocmVzdWx0Wydjb2RlJ10gPT09IDIwMCl7XHJcbi8vICAgICAgICAgICAgICAgICAgICAgeGZ6YWxlcnQuYWxlcnRTdWNjZXNzKFwi6L2u5pKt5Zu+5L+u5pS55oiQ5YqfXCIsIGZ1bmN0aW9uICgpIHtcclxuLy8gICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xyXG4vLyAgICAgICAgICAgICAgICAgICAgIH0pXHJcbi8vICAgICAgICAgICAgICAgICB9XHJcbi8vICAgICAgICAgICAgIH1cclxuLy8gICAgICAgICB9KVxyXG4vLyAgICAgfSlcclxuLy8gfTtcclxuXHJcbkJhbm5lcnMucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHNlbGYubGlzdGVuQWRkQnRuRXZlbnQoKTtcclxuICAgIHNlbGYubG9hZEJhbm5lckV2ZW50KCk7XHJcbn07XHJcblxyXG4kKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBiYW5uZXJzID0gbmV3IEJhbm5lcnMoKTtcclxuICAgIGJhbm5lcnMucnVuKCk7XHJcbn0pOyJdfQ==
