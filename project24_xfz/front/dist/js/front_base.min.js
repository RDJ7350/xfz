function FrontBase(){}function Auth(){this.maskWrapper=$(".mask-wrapper"),this.scrollWrapper=$(".scroll-wrapper"),this.smsCaptcha=$(".sms-captcha-btn")}FrontBase.prototype.run=function(){self=this,self.listenAuthBoxHover()},FrontBase.prototype.listenAuthBoxHover=function(){var t=$(".auth-box"),n=$(".user-more-box");t.hover(function(){n.show()},function(){n.hide()})},Auth.prototype.showEvent=function(){this.maskWrapper.show()},Auth.prototype.hideEvent=function(){this.maskWrapper.hide()},Auth.prototype.listenShowHide=function(){var t=this,n=$(".signin-btn"),e=$(".signup-btn"),a=$(".close-btn");n.click(function(){t.showEvent(),t.scrollWrapper.css({left:"0px"})}),e.click(function(){t.showEvent(),t.scrollWrapper.css({left:"-400px"})}),a.click(function(){t.hideEvent()})},Auth.prototype.listenSwitchEvent=function(){var n=this;$(".switch").click(function(){var t=n.scrollWrapper.css("left");(t=parseInt(t))<0?n.scrollWrapper.animate({left:"0"}):n.scrollWrapper.animate({left:"-400px"})})},Auth.prototype.listenSigninEvent=function(){var a=this,t=$(".signin-group"),s=t.find("input[name='telephone']"),i=t.find("input[name='password']"),o=t.find("input[name='remember']");t.find(".submit-btn").click(function(){var t=s.val(),n=i.val(),e=o.prop("checked");xfzajax.post({url:"/account/login/",data:{telephone:t,password:n,remember:e?1:0},success:function(t){a.hideEvent(),window.location.reload()}})})},Auth.prototype.listenSignupEvent=function(){var f=this,m=$(".signup-group");m.find(".submit-btn").click(function(t){t.preventDefault();var n=m.find("input[name='telephone']"),e=m.find("input[name='username']"),a=m.find("input[name='img_captcha']"),s=m.find("input[name='password1']"),i=m.find("input[name='password2']"),o=m.find("input[name='sms_captcha']"),c=n.val(),p=e.val(),r=a.val(),u=s.val(),l=i.val(),h=o.val();xfzajax.post({url:"/account/register/",data:{telephone:c,username:p,img_captcha:r,password1:u,password2:l,sms_captcha:h},success:function(t){f.hideEvent(),window.location.reload()}})})},Auth.prototype.listenImageCaptcha=function(){var t=$(".img-captcha");t.click(function(){t.attr("src","/account/img_captcha/?random="+Math.random())})},Auth.prototype.listenSuccessEvent=function(){var t=this;messageBox.showSuccess("短信验证码发送成功！"),t.smsCaptcha.addClass("disabled"),t.smsCaptcha.unbind("click");var n=60,e=setInterval(function(){t.smsCaptcha.text(n+"s"),--n<=0&&(clearInterval(e),t.smsCaptcha.removeClass("disabled"),t.smsCaptcha.text("发送验证码"),t.listenSmsCaptcha())},1e3)},Auth.prototype.listenSmsCaptcha=function(){var n=this,e=$(".signup-group input[name=telephone]");n.smsCaptcha.click(function(){var t=e.val();t||messageBox.showInfo("请输入手机号码！"),xfzajax.get({url:"/account/sms_captcha/",data:{telephone:t},success:function(t){n.listenSuccessEvent()}})})},Auth.prototype.run=function(){var t=this;t.listenShowHide(),t.listenSwitchEvent(),t.listenSigninEvent(),t.listenImageCaptcha(),t.listenSmsCaptcha(),t.listenSignupEvent()},$(function(){(new Auth).run()}),$(function(){(new FrontBase).listenAuthBoxHover()}),$(function(){window.template&&(template.defaults.imports.timeSince=function(t){var n=new Date(t),e=n.getTime(),a=((new Date).getTime()-e)/1e3;return a<60?"刚刚":60<=a&&a<3600?parseInt(a/60)+"分钟前":3600<=a&&a<86400?parseInt(a/60/60)+"小时前":86400<=a&&a<2592e3?parseInt(a/60/60/24)+"天前":n.getFullYear()+"/"+n.getMonth()+"/"+n.getDay()+"/"+n.getHours()+":"+n.getMinutes()})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZyb250X2Jhc2UuanMiXSwibmFtZXMiOlsiRnJvbnRCYXNlIiwiQXV0aCIsInRoaXMiLCJtYXNrV3JhcHBlciIsIiQiLCJzY3JvbGxXcmFwcGVyIiwic21zQ2FwdGNoYSIsInByb3RvdHlwZSIsInJ1biIsInNlbGYiLCJsaXN0ZW5BdXRoQm94SG92ZXIiLCJhdXRoQm94IiwidXNlck1vcmVCb3giLCJob3ZlciIsInNob3ciLCJoaWRlIiwic2hvd0V2ZW50IiwiaGlkZUV2ZW50IiwibGlzdGVuU2hvd0hpZGUiLCJzaWduaW5CdG4iLCJzaWdudXBCdG4iLCJjbG9zZUJ0biIsImNsaWNrIiwiY3NzIiwibGVmdCIsImxpc3RlblN3aXRjaEV2ZW50IiwiY3VycmVudExlZnQiLCJwYXJzZUludCIsImFuaW1hdGUiLCJsaXN0ZW5TaWduaW5FdmVudCIsInNpZ25pbkdyb3VwIiwidGVsZXBob25lSW5wdXQiLCJmaW5kIiwicGFzc3dvcmRJbnB1dCIsInJlbWVtYmVySW5wdXQiLCJ0ZWxlcGhvbmUiLCJ2YWwiLCJwYXNzd29yZCIsInJlbWVtYmVyIiwicHJvcCIsInhmemFqYXgiLCJwb3N0IiwidXJsIiwiZGF0YSIsInN1Y2Nlc3MiLCJyZXN1bHQiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsInJlbG9hZCIsImxpc3RlblNpZ251cEV2ZW50Iiwic2lnbnVwR3JvdXAiLCJldmVudCIsInByZXZlbnREZWZhdWx0IiwidXNlcm5hbWVJbnB1dCIsImltZ19jYXB0Y2hhSW5wdXQiLCJwYXNzd29yZDFJbnB1dCIsInBhc3N3b3JkMklucHV0Iiwic21zX2NhcHRjaGFJbnB1dCIsInVzZXJuYW1lIiwiaW1nX2NhcHRjaGEiLCJwYXNzd29yZDEiLCJwYXNzd29yZDIiLCJzbXNfY2FwdGNoYSIsImxpc3RlbkltYWdlQ2FwdGNoYSIsImltZ0NhcHRjaGEiLCJhdHRyIiwiTWF0aCIsInJhbmRvbSIsImxpc3RlblN1Y2Nlc3NFdmVudCIsIm1lc3NhZ2VCb3giLCJzaG93U3VjY2VzcyIsImFkZENsYXNzIiwidW5iaW5kIiwiY291bnQiLCJ0aW1lciIsInNldEludGVydmFsIiwidGV4dCIsImNsZWFySW50ZXJ2YWwiLCJyZW1vdmVDbGFzcyIsImxpc3RlblNtc0NhcHRjaGEiLCJzaG93SW5mbyIsImdldCIsInRlbXBsYXRlIiwiZGVmYXVsdHMiLCJpbXBvcnRzIiwidGltZVNpbmNlIiwidGltZVZhbHVlIiwiZGF0ZSIsIkRhdGUiLCJkYXRlcyIsImdldFRpbWUiLCJ0aW1lc3RhbXAiLCJnZXRGdWxsWWVhciIsImdldE1vbnRoIiwiZ2V0RGF5IiwiZ2V0SG91cnMiLCJnZXRNaW51dGVzIl0sIm1hcHBpbmdzIjoiQUFFQSxTQUFTQSxhQW1CVCxTQUFTQyxPQUNMQyxLQUFLQyxZQUFjQyxFQUFFLGlCQUNyQkYsS0FBS0csY0FBZ0JELEVBQUUsbUJBQ3ZCRixLQUFLSSxXQUFhRixFQUFFLG9CQWxCeEJKLFVBQVVPLFVBQVVDLElBQU0sV0FDdEJDLEtBQU9QLEtBQ1BPLEtBQUtDLHNCQUdUVixVQUFVTyxVQUFVRyxtQkFBcUIsV0FDckMsSUFBSUMsRUFBVVAsRUFBRSxhQUNaUSxFQUFjUixFQUFFLGtCQUNwQk8sRUFBUUUsTUFBTSxXQUNWRCxFQUFZRSxRQUNkLFdBQ0VGLEVBQVlHLFVBVXBCZCxLQUFLTSxVQUFVUyxVQUFZLFdBQ1pkLEtBQ05DLFlBQVlXLFFBSXJCYixLQUFLTSxVQUFVVSxVQUFhLFdBQ2JmLEtBQ05DLFlBQVlZLFFBR3JCZCxLQUFLTSxVQUFVVyxlQUFpQixXQUM1QixJQUFJVCxFQUFPUCxLQUNQaUIsRUFBWWYsRUFBRSxlQUNkZ0IsRUFBWWhCLEVBQUUsZUFDZGlCLEVBQVdqQixFQUFFLGNBQ2pCZSxFQUFVRyxNQUFNLFdBQ1piLEVBQUtPLFlBQ0xQLEVBQUtKLGNBQWNrQixJQUFJLENBQUNDLEtBQVEsVUFFcENKLEVBQVVFLE1BQU0sV0FDWmIsRUFBS08sWUFDTFAsRUFBS0osY0FBY2tCLElBQUksQ0FBQ0MsS0FBUSxhQUVwQ0gsRUFBU0MsTUFBTSxXQUNYYixFQUFLUSxlQUli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LElBQU0sV0FDakIsSUFBSUMsRUFBT1AsS0FDWE8sRUFBS1MsaUJBQ0xULEVBQUtnQixvQkFDTGhCLEVBQUtvQixvQkFDTHBCLEVBQUtzRCxxQkFDTHRELEVBQUtzRSxtQkFDTHRFLEVBQUt3QyxxQkFHVDdDLEVBQUUsWUFDYSxJQUFJSCxNQUNWTyxRQUlUSixFQUFFLFlBQ2tCLElBQUlKLFdBQ1ZVLHVCQUdkTixFQUFFLFdBQ00wQyxPQUFPb0MsV0FDUEEsU0FBU0MsU0FBU0MsUUFBUUMsVUFBWSxTQUFVQyxHQUM1QyxJQUFJQyxFQUFPLElBQUlDLEtBQUtGLEdBQ2hCRyxFQUFRRixFQUFLRyxVQUViQyxJQURRLElBQUtILE1BQVFFLFVBQ0ZELEdBQU8sSUFDOUIsT0FBSUUsRUFBWSxHQUNMLEtBQ0YsSUFBTUEsR0FBYUEsRUFBWSxLQUN0QmhFLFNBQVNnRSxFQUFZLElBQ3BCLE1BQ1IsTUFBV0EsR0FBYUEsRUFBVyxNQUM5QmhFLFNBQVNnRSxFQUFZLEdBQUssSUFDekIsTUFDTixPQUFnQkEsR0FBYUEsRUFBVyxPQUNwQ2hFLFNBQVNnRSxFQUFZLEdBQUssR0FBSyxJQUM5QixLQUVESixFQUFLSyxjQUtKLElBSkFMLEVBQUtNLFdBSUssSUFIWk4sRUFBS08sU0FHZSxJQUZuQlAsRUFBS1EsV0FFdUIsSUFEMUJSLEVBQUtTIiwiZmlsZSI6ImZyb250X2Jhc2UubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8g55m76ZmG5oiQ5Yqf5ZCO55So5oi355qESG92ZXLkuovku7ZcclxuXHJcbmZ1bmN0aW9uIEZyb250QmFzZSgpIHtcclxuXHJcbn1cclxuXHJcbkZyb250QmFzZS5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgc2VsZiA9IHRoaXM7XHJcbiAgICBzZWxmLmxpc3RlbkF1dGhCb3hIb3ZlcigpO1xyXG59O1xyXG5cclxuRnJvbnRCYXNlLnByb3RvdHlwZS5saXN0ZW5BdXRoQm94SG92ZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgYXV0aEJveCA9ICQoXCIuYXV0aC1ib3hcIik7XHJcbiAgICB2YXIgdXNlck1vcmVCb3ggPSAkKFwiLnVzZXItbW9yZS1ib3hcIik7XHJcbiAgICBhdXRoQm94LmhvdmVyKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB1c2VyTW9yZUJveC5zaG93KCk7XHJcbiAgICB9LGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB1c2VyTW9yZUJveC5oaWRlKCk7XHJcbiAgICB9KVxyXG59O1xyXG5cclxuZnVuY3Rpb24gQXV0aCgpIHtcclxuICAgIHRoaXMubWFza1dyYXBwZXIgPSAkKCcubWFzay13cmFwcGVyJyk7XHJcbiAgICB0aGlzLnNjcm9sbFdyYXBwZXIgPSAkKFwiLnNjcm9sbC13cmFwcGVyXCIpO1xyXG4gICAgdGhpcy5zbXNDYXB0Y2hhID0gJChcIi5zbXMtY2FwdGNoYS1idG5cIik7XHJcbn1cclxuXHJcbkF1dGgucHJvdG90eXBlLnNob3dFdmVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHNlbGYubWFza1dyYXBwZXIuc2hvdygpO1xyXG5cclxufTtcclxuXHJcbkF1dGgucHJvdG90eXBlLmhpZGVFdmVudCA9ICBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBzZWxmLm1hc2tXcmFwcGVyLmhpZGUoKTtcclxufTtcclxuXHJcbkF1dGgucHJvdG90eXBlLmxpc3RlblNob3dIaWRlID0gZnVuY3Rpb24oKXtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHZhciBzaWduaW5CdG4gPSAkKFwiLnNpZ25pbi1idG5cIik7XHJcbiAgICB2YXIgc2lnbnVwQnRuID0gJChcIi5zaWdudXAtYnRuXCIpO1xyXG4gICAgdmFyIGNsb3NlQnRuID0gJChcIi5jbG9zZS1idG5cIik7XHJcbiAgICBzaWduaW5CdG4uY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHNlbGYuc2hvd0V2ZW50KCk7XHJcbiAgICAgICAgc2VsZi5zY3JvbGxXcmFwcGVyLmNzcyh7XCJsZWZ0XCI6IFwiMHB4XCJ9KTtcclxuICAgIH0pO1xyXG4gICAgc2lnbnVwQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBzZWxmLnNob3dFdmVudCgpO1xyXG4gICAgICAgIHNlbGYuc2Nyb2xsV3JhcHBlci5jc3Moe1wibGVmdFwiOiBcIi00MDBweFwifSk7XHJcbiAgICB9KTtcclxuICAgIGNsb3NlQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBzZWxmLmhpZGVFdmVudCgpO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5Td2l0Y2hFdmVudCA9IGZ1bmN0aW9uKCl7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB2YXIgc3dpdGNoZXIgPSAkKFwiLnN3aXRjaFwiKTtcclxuICAgIHN3aXRjaGVyLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgY3VycmVudExlZnQgPSBzZWxmLnNjcm9sbFdyYXBwZXIuY3NzKFwibGVmdFwiKTtcclxuICAgICAgICBjdXJyZW50TGVmdCA9IHBhcnNlSW50KGN1cnJlbnRMZWZ0KTtcclxuICAgICAgICBpZihjdXJyZW50TGVmdDwwKXtcclxuICAgICAgICAgICAgc2VsZi5zY3JvbGxXcmFwcGVyLmFuaW1hdGUoe1wibGVmdFwiOlwiMFwifSk7XHJcbiAgICAgICAgfWVsc2Uge1xyXG4gICAgICAgICAgICBzZWxmLnNjcm9sbFdyYXBwZXIuYW5pbWF0ZSh7XCJsZWZ0XCI6XCItNDAwcHhcIn0pO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59O1xyXG5cclxuQXV0aC5wcm90b3R5cGUubGlzdGVuU2lnbmluRXZlbnQgPSBmdW5jdGlvbigpe1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdmFyIHNpZ25pbkdyb3VwID0gJChcIi5zaWduaW4tZ3JvdXBcIik7XHJcbiAgICB2YXIgdGVsZXBob25lSW5wdXQgPSBzaWduaW5Hcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ndGVsZXBob25lJ11cIik7XHJcbiAgICB2YXIgcGFzc3dvcmRJbnB1dCA9IHNpZ25pbkdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdwYXNzd29yZCddXCIpO1xyXG4gICAgdmFyIHJlbWVtYmVySW5wdXQgPSBzaWduaW5Hcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ncmVtZW1iZXInXVwiKTtcclxuICAgIHZhciBzdWJtaXRCdG4gPSBzaWduaW5Hcm91cC5maW5kKFwiLnN1Ym1pdC1idG5cIik7XHJcblxyXG4gICAgc3VibWl0QnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgdGVsZXBob25lID0gdGVsZXBob25lSW5wdXQudmFsKCk7XHJcbiAgICAgICAgdmFyIHBhc3N3b3JkID0gcGFzc3dvcmRJbnB1dC52YWwoKTtcclxuICAgICAgICB2YXIgcmVtZW1iZXIgPSByZW1lbWJlcklucHV0LnByb3AoXCJjaGVja2VkXCIpO1xyXG5cclxuICAgICAgICB4ZnphamF4LnBvc3Qoe1xyXG4gICAgICAgICAgICAndXJsJzonL2FjY291bnQvbG9naW4vJyxcclxuICAgICAgICAgICAgJ2RhdGEnOntcclxuICAgICAgICAgICAgICAgICd0ZWxlcGhvbmUnOnRlbGVwaG9uZSxcclxuICAgICAgICAgICAgICAgICdwYXNzd29yZCc6cGFzc3dvcmQsXHJcbiAgICAgICAgICAgICAgICAncmVtZW1iZXInOnJlbWVtYmVyPzE6MCxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgJ3N1Y2Nlc3MnOmZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuaGlkZUV2ZW50KCk7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbkF1dGgucHJvdG90eXBlLmxpc3RlblNpZ251cEV2ZW50ID0gZnVuY3Rpb24oKXtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHZhciBzaWdudXBHcm91cCA9ICQoXCIuc2lnbnVwLWdyb3VwXCIpO1xyXG4gICAgdmFyIHN1Ym1pdEJ0biA9IHNpZ251cEdyb3VwLmZpbmQoXCIuc3VibWl0LWJ0blwiKTtcclxuICAgIHN1Ym1pdEJ0bi5jbGljayhmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIHZhciB0ZWxlcGhvbmVJbnB1dCA9IHNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSd0ZWxlcGhvbmUnXVwiKTtcclxuICAgICAgICB2YXIgdXNlcm5hbWVJbnB1dCA9IHNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSd1c2VybmFtZSddXCIpO1xyXG4gICAgICAgIHZhciBpbWdfY2FwdGNoYUlucHV0ID0gc2lnbnVwR3JvdXAuZmluZChcImlucHV0W25hbWU9J2ltZ19jYXB0Y2hhJ11cIik7XHJcbiAgICAgICAgdmFyIHBhc3N3b3JkMUlucHV0ID0gc2lnbnVwR3JvdXAuZmluZChcImlucHV0W25hbWU9J3Bhc3N3b3JkMSddXCIpO1xyXG4gICAgICAgIHZhciBwYXNzd29yZDJJbnB1dCA9IHNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdwYXNzd29yZDInXVwiKTtcclxuICAgICAgICB2YXIgc21zX2NhcHRjaGFJbnB1dCA9IHNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdzbXNfY2FwdGNoYSddXCIpO1xyXG5cclxuICAgICAgICB2YXIgdGVsZXBob25lID0gdGVsZXBob25lSW5wdXQudmFsKCk7XHJcbiAgICAgICAgdmFyIHVzZXJuYW1lID0gdXNlcm5hbWVJbnB1dC52YWwoKTtcclxuICAgICAgICB2YXIgaW1nX2NhcHRjaGEgPSBpbWdfY2FwdGNoYUlucHV0LnZhbCgpO1xyXG4gICAgICAgIHZhciBwYXNzd29yZDEgPSBwYXNzd29yZDFJbnB1dC52YWwoKTtcclxuICAgICAgICB2YXIgcGFzc3dvcmQyID0gcGFzc3dvcmQySW5wdXQudmFsKCk7XHJcbiAgICAgICAgdmFyIHNtc19jYXB0Y2hhID0gc21zX2NhcHRjaGFJbnB1dC52YWwoKTtcclxuXHJcbiAgICAgICAgeGZ6YWpheC5wb3N0KHtcclxuICAgICAgICAgICAgJ3VybCc6ICcvYWNjb3VudC9yZWdpc3Rlci8nLFxyXG4gICAgICAgICAgICAnZGF0YSc6IHtcclxuICAgICAgICAgICAgICAgICd0ZWxlcGhvbmUnOiB0ZWxlcGhvbmUsXHJcbiAgICAgICAgICAgICAgICAndXNlcm5hbWUnOiB1c2VybmFtZSxcclxuICAgICAgICAgICAgICAgICdpbWdfY2FwdGNoYSc6IGltZ19jYXB0Y2hhLFxyXG4gICAgICAgICAgICAgICAgJ3Bhc3N3b3JkMSc6IHBhc3N3b3JkMSxcclxuICAgICAgICAgICAgICAgICdwYXNzd29yZDInOiBwYXNzd29yZDIsXHJcbiAgICAgICAgICAgICAgICAnc21zX2NhcHRjaGEnOiBzbXNfY2FwdGNoYSxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgJ3N1Y2Nlc3MnOiBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLmhpZGVFdmVudCgpO1xyXG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgIH0pXHJcbiAgICB9KVxyXG59O1xyXG5cclxuQXV0aC5wcm90b3R5cGUubGlzdGVuSW1hZ2VDYXB0Y2hhID0gZnVuY3Rpb24oKXtcclxuICB2YXIgaW1nQ2FwdGNoYSA9ICQoXCIuaW1nLWNhcHRjaGFcIik7XHJcbiAgaW1nQ2FwdGNoYS5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgIC8vIGFjY291bnQvaW1nX2NhcHRjaGEvP3JhbmRvbT0xXHJcbiAgICAgIGltZ0NhcHRjaGEuYXR0cihcInNyY1wiLFwiL2FjY291bnQvaW1nX2NhcHRjaGEvXCIrXCI/cmFuZG9tPVwiK01hdGgucmFuZG9tKCkpXHJcbiAgfSk7XHJcbn07XHJcblxyXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5TdWNjZXNzRXZlbnQgPSBmdW5jdGlvbigpe1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgbWVzc2FnZUJveC5zaG93U3VjY2VzcyhcIuefreS/oemqjOivgeeggeWPkemAgeaIkOWKn++8gVwiKTtcclxuICAgIHNlbGYuc21zQ2FwdGNoYS5hZGRDbGFzcyhcImRpc2FibGVkXCIpO1xyXG4gICAgc2VsZi5zbXNDYXB0Y2hhLnVuYmluZChcImNsaWNrXCIpO1xyXG4gICAgdmFyIGNvdW50ID0gNjA7XHJcbiAgICB2YXIgdGltZXIgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgc2VsZi5zbXNDYXB0Y2hhLnRleHQoY291bnQrXCJzXCIpO1xyXG4gICAgICAgIGNvdW50IC0tO1xyXG4gICAgICAgIGlmIChjb3VudDw9MCkge1xyXG4gICAgICAgICAgICBjbGVhckludGVydmFsKHRpbWVyKTtcclxuICAgICAgICAgICAgc2VsZi5zbXNDYXB0Y2hhLnJlbW92ZUNsYXNzKFwiZGlzYWJsZWRcIik7XHJcbiAgICAgICAgICAgIHNlbGYuc21zQ2FwdGNoYS50ZXh0KFwi5Y+R6YCB6aqM6K+B56CBXCIpO1xyXG4gICAgICAgICAgICBzZWxmLmxpc3RlblNtc0NhcHRjaGEoKTtcclxuICAgICAgICB9XHJcbiAgICB9LDEwMDApXHJcbn07XHJcblxyXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5TbXNDYXB0Y2hhID0gZnVuY3Rpb24oKXtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHZhciB0ZWxlcGhvbmVJbnB1dCA9ICQoXCIuc2lnbnVwLWdyb3VwIGlucHV0W25hbWU9dGVsZXBob25lXVwiKTtcclxuICAgIHNlbGYuc21zQ2FwdGNoYS5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHRlbGVwaG9uZSA9IHRlbGVwaG9uZUlucHV0LnZhbCgpO1xyXG4gICAgICAgIGlmICghdGVsZXBob25lKXtcclxuICAgICAgICAgICAgbWVzc2FnZUJveC5zaG93SW5mbyhcIuivt+i+k+WFpeaJi+acuuWPt+egge+8gVwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgeGZ6YWpheC5nZXQoe1xyXG4gICAgICAgICAgICAndXJsJzogJy9hY2NvdW50L3Ntc19jYXB0Y2hhLycsXHJcbiAgICAgICAgICAgICdkYXRhJzp7XHJcbiAgICAgICAgICAgICAgICAndGVsZXBob25lJzogdGVsZXBob25lXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICdzdWNjZXNzJzogZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5saXN0ZW5TdWNjZXNzRXZlbnQoKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICB9KVxyXG4gICAgfSlcclxufTtcclxuXHJcbkF1dGgucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHNlbGYubGlzdGVuU2hvd0hpZGUoKTtcclxuICAgIHNlbGYubGlzdGVuU3dpdGNoRXZlbnQoKTtcclxuICAgIHNlbGYubGlzdGVuU2lnbmluRXZlbnQoKTtcclxuICAgIHNlbGYubGlzdGVuSW1hZ2VDYXB0Y2hhKCk7XHJcbiAgICBzZWxmLmxpc3RlblNtc0NhcHRjaGEoKTtcclxuICAgIHNlbGYubGlzdGVuU2lnbnVwRXZlbnQoKTtcclxufTtcclxuXHJcbiQoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGF1dGggPSBuZXcgQXV0aCgpO1xyXG4gICAgYXV0aC5ydW4oKTtcclxufSk7XHJcblxyXG5cclxuJChmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgZnJvbnRCYXNlID0gbmV3IEZyb250QmFzZSgpO1xyXG4gICAgZnJvbnRCYXNlLmxpc3RlbkF1dGhCb3hIb3ZlcigpO1xyXG59KTtcclxuXHJcbiQoZnVuY3Rpb24gKCkge1xyXG4gICAgaWYgKHdpbmRvdy50ZW1wbGF0ZSkge1xyXG4gICAgICAgIHRlbXBsYXRlLmRlZmF1bHRzLmltcG9ydHMudGltZVNpbmNlID0gZnVuY3Rpb24gKHRpbWVWYWx1ZSkge1xyXG4gICAgICAgICAgICB2YXIgZGF0ZSA9IG5ldyBEYXRlKHRpbWVWYWx1ZSk7XHJcbiAgICAgICAgICAgIHZhciBkYXRlcyA9IGRhdGUuZ2V0VGltZSgpO1xyXG4gICAgICAgICAgICB2YXIgbm93dHMgPSAobmV3IERhdGUoKSkuZ2V0VGltZSgpOy8vIOiOt+WPluW9k+WJjeaXtumXtFxyXG4gICAgICAgICAgICB2YXIgdGltZXN0YW1wID0gKG5vd3RzLWRhdGVzKS8xMDAwO1xyXG4gICAgICAgICAgICBpZiAodGltZXN0YW1wIDwgNjApXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJ+WImuWImic7XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKDYwIDw9IHRpbWVzdGFtcCAmJiB0aW1lc3RhbXAgPCA2MCAqIDYwKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbWludXRlcyA9IHBhcnNlSW50KHRpbWVzdGFtcCAvIDYwKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBtaW51dGVzKyfliIbpkp/liY0nO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKDYwICogNjAgPD0gdGltZXN0YW1wICYmIHRpbWVzdGFtcDwgNjAgKiA2MCAqIDI0KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaG91cnMgPSBwYXJzZUludCh0aW1lc3RhbXAgLyA2MCAvIDYwKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBob3Vycysn5bCP5pe25YmNJztcclxuICAgICAgICAgICAgfSBlbHNlIGlmICg2MCAqIDYwICogMjQgPD0gdGltZXN0YW1wICYmIHRpbWVzdGFtcDwgNjAgKiA2MCAqIDI0ICogMzApIHtcclxuICAgICAgICAgICAgICAgIHZhciBkYXlzID0gcGFyc2VJbnQodGltZXN0YW1wIC8gNjAgLyA2MCAvIDI0KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBkYXlzKyflpKnliY0nO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdmFyIHllYXIgPSBkYXRlLmdldEZ1bGxZZWFyKCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgbW9udGggPSBkYXRlLmdldE1vbnRoKCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGF5ID0gZGF0ZS5nZXREYXkoKTtcclxuICAgICAgICAgICAgICAgIHZhciBob3VyID0gZGF0ZS5nZXRIb3VycygpO1xyXG4gICAgICAgICAgICAgICAgdmFyIG1pbnV0ZSA9IGRhdGUuZ2V0TWludXRlcygpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHllYXIrXCIvXCIrbW9udGgrXCIvXCIrZGF5K1wiL1wiK2hvdXIrXCI6XCIrbWludXRlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH1cclxuICAgIH1cclxufSk7Il19
